/**
 * Background Video Block
 * Style SCSS
 **/

.pb-bgvid {
	position: relative;
	overflow: hidden;

	/* Keep natural flow until media is selected. */
	height: auto;

	/* Responsive focal point mapping (defaults to desktop). */
	--pb-bgvid-pos-x: var(--pb-bgvid-pos-x-desktop, 50%);
	--pb-bgvid-pos-y: var(--pb-bgvid-pos-y-desktop, 50%);

	/* Make sure inner blocks are comfortably editable */
	padding: 0;
}

.pb-bgvid.has-media {
	/* Height variable is set inline in edit.js/render.php only when media exists. */
	height: var(--pb-bgvid-h-desktop, 70vh);
}

/* Tablet */
@media (max-width: 1024px) {
	.pb-bgvid.has-media {
		height: var(--pb-bgvid-h-tablet);
		--pb-bgvid-pos-x: var(
			--pb-bgvid-pos-x-tablet,
			var(--pb-bgvid-pos-x-desktop, 50%)
		);
		--pb-bgvid-pos-y: var(
			--pb-bgvid-pos-y-tablet,
			var(--pb-bgvid-pos-y-desktop, 50%)
		);
	}
}

/* Mobile */
@media (max-width: 768px) {
	.pb-bgvid.has-media {
		height: var(--pb-bgvid-h-mobile);
		--pb-bgvid-pos-x: var(
			--pb-bgvid-pos-x-mobile,
			var(--pb-bgvid-pos-x-desktop, 50%)
		);
		--pb-bgvid-pos-y: var(
			--pb-bgvid-pos-y-mobile,
			var(--pb-bgvid-pos-y-desktop, 50%)
		);
	}
}

.pb-bgvid__media {
	position: absolute;
	inset: 0;
	z-index: 0;
}

.pb-bgvid__poster,
.pb-bgvid__video,
.pb-bgvid__overlay,
.pb-bgvid__vimeo {
	position: absolute;
	inset: 0;
}

.pb-bgvid__poster {
	z-index: 1;
	background-size: cover;
	background-repeat: no-repeat;
	background-position: var(--pb-bgvid-pos-x, 50%) var(--pb-bgvid-pos-y, 50%);
}

/* Keep poster as a fallback, but don't let it hide loaded media */
.pb-bgvid.has-media .pb-bgvid__poster,
.pb-bgvid.is-playing .pb-bgvid__poster {
	opacity: 0;
}

.pb-bgvid__video {
	z-index: 2;
	width: 100%;
	height: 100%;
	object-fit: cover;
	object-position: var(--pb-bgvid-pos-x, 50%) var(--pb-bgvid-pos-y, 50%);
	display: block;
}

/* Vimeo iframe wrapper (iframe itself is injected by view.js) */
.pb-bgvid__vimeo {
	z-index: 2;
	width: 100%;
	height: 100%;
	overflow: hidden;
}

/*
 * Make the Vimeo iframe behave like a cover video.
 * Center and oversize the iframe so it always fills the container.
 */
.pb-bgvid__vimeo iframe {
	position: absolute;
	inset: 0;
	width: 100%;
	height: 100%;
	border: 0;
	display: block;
}

.pb-bgvid__overlay {
	z-index: 3;
	pointer-events: none;
}

.pb-bgvid__content {
	position: relative;
	z-index: 4;
	width: 100%;
	height: 100%;
	min-height: 100%;
}

.pb-bgvid__content-inner {
	width: 100%;
	height: 100%;
	min-height: 100%;
	display: flex;
	flex-direction: column;
	gap: var(--wp--style--block-gap, 0);
}

.pb-bgvid__content-inner.is-h-left {
	align-items: flex-start;
}

.pb-bgvid__content-inner.is-h-center {
	align-items: center;
}

.pb-bgvid__content-inner.is-h-right {
	align-items: flex-end;
}

.pb-bgvid__content-inner.is-h-stretch {
	align-items: stretch;
}

.pb-bgvid__content-inner.is-v-top {
	justify-content: flex-start;
}

.pb-bgvid__content-inner.is-v-center {
	justify-content: center;
}

.pb-bgvid__content-inner.is-v-bottom {
	justify-content: flex-end;
}

.pb-bgvid__content-inner.is-v-space-between {
	justify-content: space-between;
}

.pb-bgvid__content-inner.is-v-stretch {
	justify-content: flex-start;
}

.pb-bgvid__content-inner.is-h-stretch > * {
	width: 100%;
}

.pb-bgvid__content-inner.is-v-stretch > * {
	flex: 1 1 auto;
}

/* Content area is always full width. Use an inner Group block for constraints. */
.pb-bgvid__content-inner.is-full-width > * {
	max-width: none;
}

/*
 * Keep root content Group full-width even when horizontal alignment classes
 * set `align-items` to left/center/right on the flex container.
 */
.pb-bgvid__content-inner > .wp-block-group {
	align-self: stretch;
	width: 100%;
	max-width: none;
}

/*
 * Back-compat:
 * Older saved content can include a nested wrapper from save.js where
 * core layout classes are applied (is-layout-flex, is-content-justification-*).
 * Keep that wrapper full-height to avoid top-aligned content regressions.
 */
.pb-bgvid__content > .wp-block-folioblocks-background-video-block {
	width: 100%;
	height: 100%;
	min-height: 100%;
}

/*
 * Gutenberg editor niceties
 * - Ensure the inner block list appender is clickable above the media layer.
 */
.pb-bgvid__content .block-list-appender {
	position: relative;
	z-index: 2;
}
